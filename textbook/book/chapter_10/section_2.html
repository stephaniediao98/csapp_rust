<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Files</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../introduction.html">Introduction</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.</strong> Draft chapter</div></li><li class="chapter-item expanded "><a href="../chapter_2/chapter_2.html"><strong aria-hidden="true">2.</strong> Representing and Manipulating Information</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Draft chapter</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Draft chapter</div></li><li class="chapter-item expanded "><a href="../chapter_5/chapter_5.html"><strong aria-hidden="true">5.</strong> Optimizing Program Performance</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Draft chapter</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> Draft chapter</div></li><li class="chapter-item expanded "><a href="../chapter_8/chapter_8.html"><strong aria-hidden="true">8.</strong> Exceptional Control Flow</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> Draft chapter</div></li><li class="chapter-item expanded "><a href="../chapter_10/chapter_10.html"><strong aria-hidden="true">10.</strong> System-Level I/O</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../chapter_10/section_1.html"><strong aria-hidden="true">10.1.</strong> Unix I/O</a></li><li class="chapter-item expanded "><a href="../chapter_10/section_2.html" class="active"><strong aria-hidden="true">10.2.</strong> Files</a></li><li class="chapter-item expanded "><a href="../chapter_10/section_3.html"><strong aria-hidden="true">10.3.</strong> Opening and Closing Files</a></li><li class="chapter-item expanded "><a href="../chapter_10/section_4.html"><strong aria-hidden="true">10.4.</strong> Reading and Writing Files</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.5.</strong> Robust Reading and Writing with the Rio Package</div></li><li class="chapter-item expanded "><a href="../chapter_10/section_6.html"><strong aria-hidden="true">10.6.</strong> Reading File Metadata</a></li><li class="chapter-item expanded "><a href="../chapter_10/section_7.html"><strong aria-hidden="true">10.7.</strong> Reading Directory Contents</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.8.</strong> Sharing Files</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.9.</strong> I/O Redirection</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.10.</strong> Standard I/O (Omitted)</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.11.</strong> Putting it Together: Which I/O Functions Should I Use?</div></li></ol></li><li class="chapter-item expanded "><a href="../chapter_11/chapter_11.html"><strong aria-hidden="true">11.</strong> Network Programming</a></li><li class="chapter-item expanded "><a href="../chapter_12/chapter_12.html"><strong aria-hidden="true">12.</strong> Concurrent Programming</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        

                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="102---files"><a class="header" href="#102---files">10.2   Files</a></h1>
<h2 id="1021---linux-file-types"><a class="header" href="#1021---linux-file-types">10.2.1   Linux File Types</a></h2>
<p>The Linux system categorizes files into different <strong>types</strong>, where a file's type indicates its role in the system. Linux file types include:</p>
<ul>
<li><em>Regular files:</em> These contain arbitrary data. There are two subtypes: <em>text files</em> and <em>binary files</em>. Text files are files that contain only ASCII or Unicode characters, and binary files are all other regular files. Applications usually distinguish between these two, but the kernel doesn't.</li>
<li><em>Directories:</em> These are files that maintain the mappings between filenames and files, which can be other directories. You can think of them as folders in your filesystem. They contain an array of <em>links</em>, where each link is the mapping between a filename and a file. Each directory contains at least two entries: 
<ol>
<li><code>.</code> (dot) - a link to the directory itself </li>
<li><code>..</code> (dot-dot) - a link to the <em>parent directory</em> in the directory hierarchy</li>
</ol>
</li>
<li><em>Sockets:</em> These types of files are used in network programming to communicate with another process across a network.</li>
</ul>
<p>There are other types of files specified by the Linux system, but those are beyond our scope for now. </p>
<h2 id="1022---the-linux-filesystem"><a class="header" href="#1022---the-linux-filesystem">10.2.2   The Linux Filesystem</a></h2>
<p>The Linux filesystem is organized as a <strong>single directory hierarchy</strong> that is anchored by a <strong>root directory</strong> named <code>/</code> (slash). This structure is similar to that of a tree. Every file in the filesystem is a child of the root, either directly or indirectly.</p>
<p>Pathnames identify locations in the directory hierarchy. They are formatted strings that follow the pattern <code>/filename1/filename2/.../filename3</code>, where the first slash <code>/</code> is optional. There are two forms of pathnames: </p>
<ol>
<li><em>Absolute pathnames:</em> These pathnames start with a slash, and they denote a path from the root node. </li>
<li><em>Relative pathnames:</em> These pathnames start with a filename, and they denote a path from the current working directory, not the root. </li>
</ol>
<h2 id="1023---a-short-aside-on-processes"><a class="header" href="#1023---a-short-aside-on-processes">10.2.3   A Short Aside on Processes</a></h2>
<p>We mentioned earlier that I/O is closely related to other systems ideas. One of these ideas is a process. Processes and I/O often work together, as I/O plays a central role in process creation and execution, while process creation plays a central role in how files are shared betwen processes. </p>
<p>A <strong>process</strong> is an instance of a program being executed. One component of a process is its <strong>context</strong>, which saves information about its current state. One piece of information that is included in a process's context is its current location, which is also known as its <strong>current working directory</strong>. You can change your shell's current working directory using the <code>cd</code> command.</p>
<h2 id="1024---how-files-are-represented-in-rust"><a class="header" href="#1024---how-files-are-represented-in-rust">10.2.4   How Files are Represented in Rust</a></h2>
<p>In the upcoming sections, we will show you how to use Rust's standard library to perform I/O. Most of these I/O functions revolve around the <a href="https://doc.rust-lang.org/std/fs/struct.File.html"><code>File</code></a> struct in Rust's standard library. However, I/O functions can also be performed on other types, such as <a href="https://doc.rust-lang.org/std/net/struct.TcpStream.html"><code>TcpStream</code></a> and <a href="https://doc.rust-lang.org/std/vec/struct.Vec.html"><code>Vec&lt;T&gt;</code></a>.</p>
<p>The <code>File</code> struct represents a reference to an open file on the filesystem. </p>
<pre><code class="language-rust ignore">pub struct File {
    inner: fs_imp::File,
}
</code></pre>
<p><code>File</code> contains one member: <code>inner</code>, which is of the type <code>fs_imp::File</code>, where <code>fs_imp</code> is an identifier for the [<code>sys::fs</code>] crate. The <code>sys::fs</code> crate is part of the internal docs and is not part of Rust's public API. However, we will provide a brief overview of its <code>File</code> struct so that you can have a general idea of what's going on under the hood. Furthermore, since we're focusing on Unix in this textbook, we specifically want to look at <a href="https://stdrs.dev/nightly/x86_64-unknown-linux-gnu/std/sys/unix/fs/index.html"><code>std::sys::unix::fs::File</code></a>. </p>
<pre><code class="language-rust ignore">pub struct File(FileDesc);
</code></pre>
<p><a href="https://stdrs.dev/nightly/x86_64-unknown-linux-gnu/std/sys/unix/fd/struct.FileDesc.html"><code>FileDesc</code></a> comes from the <a href="https://stdrs.dev/nightly/x86_64-unknown-linux-gnu/std/sys/unix/fd/index.html"><code>std::sys::unix::fd</code></a> module and is a <code>c_int</code>, which is defined in <a href="https://docs.rs/libc/0.2.43/libc/type.c_int.html"><code>libc::c_int</code></a> as an <code>i32</code>. The <code>std::sys::unix::fd</code> is a nightly-only experimental API, so you will need to have <code>nightly</code> installed in order to directly run code from the <code>std::sys::unix</code> crate. </p>
<p>In short, <code>File</code> is a generic type that contains one member, <code>inner</code>, which implements the system-specific file representation for the appropriate platform. On Unix systems, <code>inner</code> is a <code>std::sys::unix::fs::File</code> type, where the file contians a file descriptor, <code>FileDesc</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../chapter_10/section_1.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../chapter_10/section_3.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../chapter_10/section_1.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../chapter_10/section_3.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
